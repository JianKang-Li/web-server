(function(){"use strict";var t={2847:function(t,e,s){var i=s(6369),a=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("el-container",[e("el-header",[e("Ahead")],1),e("el-main",[e("UpLoad"),e("FileList")],1),e("el-footer",[e("div",{staticClass:"footer"},[e("p",[t._v(" Design By "),e("el-link",{attrs:{href:"https://github.com/JianKang-Li",target:"_blank",type:"primary"}},[t._v("ljk")])],1)])])],1)],1)},o=[],n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"upload"},[e("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",action:"","http-request":t.httpRequest,"auto-upload":!1,"on-progress":t.proUpdata,name:"file",multiple:!0}},[e("i",{staticClass:"el-icon-upload"}),e("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),e("em",[t._v("点击上传")])])]),e("el-progress",{attrs:{id:"progress",percentage:t.percentage,format:t.format,status:t.status}}),e("el-button",{attrs:{type:"primary",size:"default"},on:{click:t.submitUpload}},[t._v("上传")])],1)},l=[],r=s(6265),u=s.n(r);class c{constructor(){this._axios=u().create({})}}var p=new c;const d=()=>p._axios.get("/menu"),f=t=>p._axios.get("/delete?file="+t),h=()=>p._axios.get("/ip");var g={data(){return{percentage:0,fileList:[],status:null}},methods:{format(t){return`${t}%`},submitUpload(){this.$refs.upload.submit()},proUpdata(t){console.log(t),this.percentage=parseInt(t.percent),console.log(this.percentage),this.percentage>=100&&(this.percentage=100,setTimeout((()=>{this.percentage=0}),1e3))},httpRequest(t){var e=new FormData;e.append("filename",t.file),p._axios({method:"post",url:"/upload",data:e,onUploadProgress:t=>{const e=parseInt(t.loaded/t.total*100);this.percentage=e}}).then((t=>{200===t.data.status?(this.$notify({title:"成功",message:"文件上传成功",type:"success"}),setTimeout((()=>{this.percentage=0}),1e3),this.ws.send("update"),d().then((t=>{this.$store.dispatch("updata",t.data)}))):this.$notify.error({title:"错误",message:t.data.message}),this.$refs.upload.clearFiles()})).catch((t=>{console.log(t)}))}},watch:{status(){return 100===this.percentage?"success":""}},mounted(){3===this.ws.readyState&&window.setInterval((function(){d()}))}},v=g,m=s(1001),b=(0,m.Z)(v,n,l,!1,null,"1fe0ea17",null),w=b.exports,y=(s(6699),function(){var t=this,e=t._self._c;return e("div",{staticClass:"table"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:this.$store.state.menu}},[e("el-table-column",{attrs:{prop:"index",label:"序号"}}),e("el-table-column",{attrs:{prop:"filename",label:"文件名","show-overflow-tooltip":!0}}),e("el-table-column",{attrs:{label:"下载"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("a",{attrs:{download:s.row.filename,href:"./public/files/"+s.row.filename}},[t._v("下载")])]}}])}),e("el-table-column",{attrs:{label:"预览"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-button",{attrs:{type:"primary",size:"default"},on:{click:function(e){return t.preview(s.row.filename,"/public/files/"+s.row.filename)}}},[t._v("预览")])]}}])}),e("el-table-column",{attrs:{label:"删除"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-button",{attrs:{type:"danger",size:"default"},on:{click:function(e){return t.open(s.row.filename)}}},[t._v("删除")])]}}])})],1),e("el-dialog",{attrs:{title:"删除确认",visible:t.DeleteDialog,width:"fit-content",center:""},on:{"update:visible":function(e){t.DeleteDialog=e}}},[e("span",[t._v("是否确认删除文件"+t._s(t.file))]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.DeleteDialog=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.Delete()}}},[t._v("确 定")])],1)]),e("div",[e("el-dialog",{attrs:{title:"预览窗口",visible:t.centerDialogVisible,width:"60%",center:""},on:{"update:visible":function(e){t.centerDialogVisible=e},close:t.Pclose}},[e("div",[this.pics.includes(this.type)?e("img",{staticClass:"perv",attrs:{src:t.url,alt:""}}):this.audios.includes(this.type)?e("audio",{ref:"audio",staticClass:"perv",attrs:{src:t.url,controls:""}}):this.videos.includes(this.type)?e("video",{ref:"video",staticClass:"perv",attrs:{src:t.url,controls:""}}):this.texts.includes(this.type)?e("object",{ref:"pdf"}):e("span",{staticClass:"perv"},[t._v("浏览器不支持此类型文件!")])])])],1)],1)}),_=[],D={name:"App",data(){return{url:"",centerDialogVisible:!1,DeleteDialog:!1,file:"",type:"",pics:["jpg","png","webp","jpeg","bmp","gif","apng","avif","ico"],audios:["mp3","ogg","wav"],videos:["mp4","webm"],texts:["pdf","txt"],reader:null}},methods:{getMenu(){d().then((t=>{this.$store.dispatch("updata",t.data)}))},Pclose(){this.$refs.audio?this.$refs.audio.pause():this.$refs.video&&this.$refs.video.pause()},preview(t,e){let s=t.match(/\.\w*$/g)[0];this.type=s.replace(".",""),this.texts.includes(this.type)?console.log("pdf,txt"):this.Dev?this.url=this.globalUrl+e:this.url=e,this.centerDialogVisible=!0},Delete(){f(this.file).then((t=>{this.$message({type:"success",message:`${t.data}`}),this.ws.send("delete")})).catch((t=>{this.$message({type:"warning",message:`${t}`})})),this.getMenu(),this.DeleteDialog=!1},open(t){this.file=t,this.DeleteDialog=!0}},mounted(){this.getMenu(),this.ws.onmessage=t=>{console.log(t.data),this.getMenu()},3===this.ws.readyState&&(window.timer=setInterval((()=>{this.getMenu()}),3e3))},beforeDestroy(){clearInterval(window.timer)}},x=D,k=(0,m.Z)(x,y,_,!1,null,"eb8e27e2",null),$=k.exports,C=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("div",{staticClass:"logo"},[t._v("AirDrop")]),e("div",{staticClass:"tip"},[e("el-button",{on:{click:function(e){t.centerDialogVisible=!0}}},[t._v("Tips")])],1)]),e("el-dialog",{attrs:{title:"Tips",visible:t.centerDialogVisible,width:"fit-content",center:""},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[e("p",[t._v("页面预览文件类型靠自定义和浏览器支持")]),e("p",[t._v("后续可能增加登录功能")]),e("p",[t._v("此项目仅用于私人使用，请勿用于商业使用")]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.centerDialogVisible=!1}}},[t._v("确 定")])],1)])],1)},O=[],S={data(){return{centerDialogVisible:!1}}},j=S,T=(0,m.Z)(j,C,O,!1,null,"11b06f27",null),P=T.exports,U={name:"App",components:{UpLoad:w,FileList:$,Ahead:P}},V=U,M=(0,m.Z)(V,a,o,!1,null,"31132a64",null),L=M.exports,Z=s(8499),A=s.n(Z),F=s(3822);i["default"].use(F.ZP);const I=new F.ZP.Store({state:{menu:[]},actions:{updata(t,e){t.commit("flash",e)}},mutations:{flash(t,e){t.menu=e}}});var q=I;i["default"].config.productionTip=!1,i["default"].prototype.globalUrl="http://127.0.0.1:8888",i["default"].prototype.Dev=!1,i["default"].use(A()),h().then((t=>{let e=t.data,s=new WebSocket(`ws://${e}:8089`);s.onopen=()=>{console.log("ws open")},s.onclose=()=>{alert("ws close")},i["default"].prototype.ws=s})),setTimeout((()=>{new i["default"]({render:t=>t(L),store:q}).$mount("#app")}),100)}},e={};function s(i){var a=e[i];if(void 0!==a)return a.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,s),o.exports}s.m=t,function(){var t=[];s.O=function(e,i,a,o){if(!i){var n=1/0;for(c=0;c<t.length;c++){i=t[c][0],a=t[c][1],o=t[c][2];for(var l=!0,r=0;r<i.length;r++)(!1&o||n>=o)&&Object.keys(s.O).every((function(t){return s.O[t](i[r])}))?i.splice(r--,1):(l=!1,o<n&&(n=o));if(l){t.splice(c--,1);var u=a();void 0!==u&&(e=u)}}return e}o=o||0;for(var c=t.length;c>0&&t[c-1][2]>o;c--)t[c]=t[c-1];t[c]=[i,a,o]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};s.O.j=function(e){return 0===t[e]};var e=function(e,i){var a,o,n=i[0],l=i[1],r=i[2],u=0;if(n.some((function(e){return 0!==t[e]}))){for(a in l)s.o(l,a)&&(s.m[a]=l[a]);if(r)var c=r(s)}for(e&&e(i);u<n.length;u++)o=n[u],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(c)},i=self["webpackChunkairdrop"]=self["webpackChunkairdrop"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=s.O(void 0,[998],(function(){return s(2847)}));i=s.O(i)})();
//# sourceMappingURL=app.c893d915.js.map